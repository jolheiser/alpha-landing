<form class="sm:max-w-md block" id="early-access-form">
    <div class="bg-white shadow rounded-lg flex flex-col sm:flex-row">
        <input
            type="email"
            placeholder="email@example.com"
            id="early-access-input"
            class="
                  px-4 py-3 flex-grow min-w-0
                  bg-transparent placeholder-gray-500 text-gray-600">
        </input>
        <button
            id="early-access-button"
            type="submit"
            class="
                early-access-button
                px-4 py-3
                rounded-lg rounded-t-none
                sm:rounded-lg sm:rounded-l-none
                bg-teal-500 text-white flex-shrink-0">
            Get Early Access
        </button>
    </div>
    <div class="text-sm my-2 text-teal-500 font-bold" id="early-access-feedback">
        <!-- Here's where feedback from the API is rendered -->
    </div>
</form>

<script>
document.getElementById("early-access-form").addEventListener("submit", function(e) {
    e.preventDefault();
    let email = document.getElementById("early-access-input").value;
    document.getElementById("early-access-feedback").textContent = "Registering..."
    // Spaghetti!!
    fetch(
        // Change!
        "https://codecrafters-registry.herokuapp.com/users/creat",
        {
            'method': 'POST',
            'body': JSON.stringify({"email_address": email}),
            'headers': { 'Content-type': 'application/json' }
        }
    )
    .then((resp) => resp.text())
    .then(function (text) {
        // document.getElementById("early-access-feedback").textContent = text
        document.getElementById("early-access-feedback").textContent = "Thanks for signing up."
    })
    .catch(function (error) {
        console.error(error)
        alert(error);
    })
})
</script>
